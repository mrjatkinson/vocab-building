<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>French Vocabulary Learning - Multi Lesson Quiz</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 720px;
    margin: 2rem auto;
    padding: 1rem;
    background: #f9fafb;
    color: #222;
  }
  h1, h2 {
    text-align: center;
    color: #1a202c;
  }
  .lesson {
    display: none;
    background: white;
    padding: 1rem 2rem 2rem 2rem;
    border-radius: 10px;
    box-shadow: 0 0 8px rgba(0,0,0,0.1);
    margin-bottom: 1rem;
  }
  .lesson.active {
    display: block;
  }
  .question {
    margin-bottom: 1.5rem;
  }
  .question label {
    display: block;
    margin-bottom: 0.25rem;
    cursor: pointer;
  }
  input[type="radio"], input[type="checkbox"] {
    margin-right: 0.5rem;
  }
  textarea, input[type="text"] {
    width: 100%;
    font-size: 1rem;
    padding: 0.3rem 0.5rem;
    border: 1px solid #ccc;
    border-radius: 6px;
    margin-top: 0.3rem;
  }
  button {
    background: #4c51bf;
    color: white;
    padding: 0.6rem 1.2rem;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    font-size: 1rem;
    margin-top: 0.5rem;
  }
  button:disabled {
    background: #a0aec0;
    cursor: not-allowed;
  }
  .feedback {
    margin-top: 0.3rem;
    font-weight: 600;
  }
  .feedback.correct {
    color: #38a169;
  }
  .feedback.incorrect {
    color: #e53e3e;
  }
  #navigation {
    text-align: center;
    margin: 2rem 0 1rem 0;
  }
  #navigation button {
    margin: 0 1rem;
  }
  #progress-bar {
    background: #e2e8f0;
    border-radius: 12px;
    height: 18px;
    margin: 1rem 0 2rem 0;
    overflow: hidden;
  }
  #progress-fill {
    background: #667eea;
    height: 100%;
    width: 0%;
    transition: width 0.4s ease;
  }
  #final-score {
    text-align: center;
    font-size: 1.3rem;
    font-weight: 700;
    color: #2d3748;
    margin-top: 2rem;
    background: #c6f6d5;
    padding: 1rem 2rem;
    border-radius: 10px;
  }
</style>
</head>
<body>

<h1>French Vocabulary Learning</h1>
<div id="progress-bar"><div id="progress-fill"></div></div>

<!-- Container for all lessons -->
<div id="lessons-container"></div>

<div id="navigation">
  <button id="prevLessonBtn" disabled>← Previous Lesson</button>
  <button id="nextLessonBtn">Next Lesson →</button>
</div>

<div id="final-score" style="display:none;"></div>

<script>
  // Lessons data: Array of lessons; each lesson has title and questions.
  // Questions: type: "mcq" (multiple choice), "text" (written input), "order" (sentence reorder), "select" (click selection)
  // Each question has question text, choices (for mcq/select/order), correct answer(s), feedback, etc.
  
  const lessons = [
  // Lesson 1
  {
    title: "Leçon 1: L’entretien (Interview Vocabulary)",
    questions: [
      { id: "q1", type: "mcq", question: "Que signifie 'un entretien'?", choices: ["A party", "An interview", "A song", "A competition"], correct: "An interview", feedbackCorrect: "Correct! 'Un entretien' means 'an interview'.", feedbackIncorrect: "Incorrect. 'Un entretien' means 'an interview'." },
      { id: "q2", type: "mcq", question: "Comment dit-on 'There will be' en français?", choices: ["Il y a", "Il y aura", "Il y avait", "Il est"], correct: "Il y aura", feedbackCorrect: "Bien joué! 'Il y aura' means 'There will be'.", feedbackIncorrect: "Non, la bonne réponse est 'Il y aura'." },
      { id: "q3", type: "order", question: "Remettez les mots dans le bon ordre: 'soirée / une / J’ai / hier'.", choices: ["J’ai", "une", "soirée", "hier"], correctOrder: ["J’ai", "une", "soirée", "hier"], feedbackCorrect: "Très bien! La phrase correcte est 'J’ai une soirée hier'.", feedbackIncorrect: "Pas tout à fait. Essayez de remettre les mots dans le bon ordre." },
      { id: "q4", type: "text", question: "Complétez la phrase: 'Je ___ confiance en moi.' (use 'avoir')", correctKeywords: ["ai", "confiance"], feedbackCorrect: "Bravo! 'J’ai confiance en moi.' signifie 'I have confidence in myself.'", feedbackIncorrect: "Incorrect. La phrase correcte est 'J’ai confiance en moi.'" },
      { id: "q5", type: "select", question: "Quelle est la bonne traduction pour 'to sing'?", choices: ["Chanter", "Courir", "Écrire", "Manger"], correct: "Chanter", feedbackCorrect: "Exact! 'Chanter' signifie 'to sing'.", feedbackIncorrect: "Non, 'Chanter' est la bonne réponse." },
      { id: "q6", type: "mcq", question: "Que veut dire 'dernier'?", choices: ["Last/latest", "First", "Soon", "Early"], correct: "Last/latest", feedbackCorrect: "Correct! 'Dernier' signifie 'last' ou 'latest'.", feedbackIncorrect: "Non, 'dernier' veut dire 'last' ou 'latest'." },
      { id: "q7", type: "order", question: "Remettez en ordre: 'Il / y / a / un concours'.", choices: ["Il", "y", "a", "un concours"], correctOrder: ["Il", "y", "a", "un concours"], feedbackCorrect: "Bien joué! La phrase correcte est 'Il y a un concours'.", feedbackIncorrect: "Pas tout à fait. Essayez encore." },
      { id: "q8", type: "text", question: "Traduisez: 'I hope to succeed' (use 'j’espère')", correctKeywords: ["j’espère"], feedbackCorrect: "Bravo! 'J’espère réussir' est une bonne traduction.", feedbackIncorrect: "Non, essayez d’utiliser 'j’espère' dans la phrase." },
      { id: "q9", type: "mcq", question: "Que veut dire 'une soirée'?", choices: ["An evening", "A morning", "A night", "A weekend"], correct: "An evening", feedbackCorrect: "'Une soirée' signifie 'an evening'.", feedbackIncorrect: "Non, 'une soirée' veut dire 'an evening'." },
      { id: "q10", type: "select", question: "Comment dit-on 'to have confidence' en français?", choices: ["Avoir confiance", "Être content", "Faire attention", "Prendre soin"], correct: "Avoir confiance", feedbackCorrect: "Exact! 'Avoir confiance' signifie 'to have confidence'.", feedbackIncorrect: "Non, la bonne réponse est 'avoir confiance'." }
    ]
  },

  // Lesson 2
  {
    title: "Leçon 2: La technologie et les opinions",
    questions: [
      { id: "q1", type: "mcq", question: "Que signifie 'regarder des émissions en streaming'?", choices: ["To play games online", "To watch streaming shows", "To listen to music", "To surf the internet"], correct: "To watch streaming shows", feedbackCorrect: "Correct! Cela signifie 'to watch streaming shows'.", feedbackIncorrect: "Incorrect. Cela veut dire 'to watch streaming shows'." },
      { id: "q2", type: "select", question: "Quelle est la bonne traduction de 'écouter de la musique en ligne'?", choices: ["To listen to music online", "To play video games", "To watch videos", "To write emails"], correct: "To listen to music online", feedbackCorrect: "Exact! Cela signifie 'to listen to music online'.", feedbackIncorrect: "Non, la bonne réponse est 'to listen to music online'." },
      { id: "q3", type: "order", question: "Réorganisez la phrase: 'Je / préfère / jouer à des jeux en ligne'.", choices: ["Je", "préfère", "jouer à des jeux en ligne"], correctOrder: ["Je", "préfère", "jouer à des jeux en ligne"], feedbackCorrect: "Très bien! La phrase correcte est 'Je préfère jouer à des jeux en ligne'.", feedbackIncorrect: "Essayez de remettre les mots dans le bon ordre." },
      { id: "q4", type: "text", question: "Complétez: 'J’aime ___ des vidéos sur YouTube.' (verbe)", correctKeywords: ["regarder"], feedbackCorrect: "Bravo! 'J’aime regarder des vidéos sur YouTube.'", feedbackIncorrect: "Non, la bonne réponse est 'J’aime regarder des vidéos sur YouTube.'" },
      { id: "q5", type: "mcq", question: "Que veut dire 'sufer et trouver des sites intéressants'?", choices: ["To surf and find interesting websites", "To swim", "To dance", "To sing"], correct: "To surf and find interesting websites", feedbackCorrect: "Correct! Cela signifie 'to surf and find interesting websites'.", feedbackIncorrect: "Non, cela veut dire 'to surf and find interesting websites'." },
      { id: "q6", type: "select", question: "Quel verbe signifie 'to listen'?", choices: ["écouter", "jouer", "regarder", "chanter"], correct: "écouter", feedbackCorrect: "Exact! 'écouter' signifie 'to listen'.", feedbackIncorrect: "Non, la bonne réponse est 'écouter'." },
      { id: "q7", type: "order", question: "Remettez en ordre: 'Il / aime / écouter / de la musique'.", choices: ["Il", "aime", "écouter", "de la musique"], correctOrder: ["Il", "aime", "écouter", "de la musique"], feedbackCorrect: "Bien joué! La phrase correcte est 'Il aime écouter de la musique'.", feedbackIncorrect: "Essayez encore." },
      { id: "q8", type: "text", question: "Traduisez: 'I prefer to watch videos in the evening.' (Use 'je préfère')", correctKeywords: ["je", "préfère", "regarder", "vidéos", "le soir"], feedbackCorrect: "Très bien! La phrase pourrait être: 'Je préfère regarder des vidéos le soir.'", feedbackIncorrect: "Non, essayez d’utiliser les mots-clés donnés." },
      { id: "q9", type: "mcq", question: "Quel mot correspond à 'online'?", choices: ["en ligne", "à la maison", "hier", "ce soir"], correct: "en ligne", feedbackCorrect: "Correct! 'En ligne' signifie 'online'.", feedbackIncorrect: "Non, la bonne réponse est 'en ligne'." },
      { id: "q10", type: "select", question: "Quelle phrase exprime une opinion?", choices: ["Je joue à des jeux en ligne.", "J’écoute de la musique en ligne.", "J’aime regarder des vidéos.", "Il y a un concours."], correct: "J’aime regarder des vidéos.", feedbackCorrect: "Exact! 'J’aime regarder des vidéos.' exprime une opinion.", feedbackIncorrect: "Non, cherchez une phrase exprimant une opinion." }
    ]
  },

  // Lesson 3
  {
    title: "Leçon 3: Le futur proche et les activités",
    questions: [
      { id: "q1", type: "mcq", question: "Que signifie 'Je vais chanter demain'?", choices: ["I am singing now", "I will sing tomorrow", "I sang yesterday", "I don't like singing"], correct: "I will sing tomorrow", feedbackCorrect: "Correct! 'Je vais chanter demain' means 'I will sing tomorrow'.", feedbackIncorrect: "Incorrect. It means 'I will sing tomorrow'." },
      { id: "q2", type: "select", question: "Quel est l'infinitif du verbe 'joue'?", choices: ["jouer", "jouais", "joué", "jouera"], correct: "jouer", feedbackCorrect: "Exact! L'infinitif est 'jouer'.", feedbackIncorrect: "Non, c'est 'jouer'." },
      { id: "q3", type: "order", question: "Réorganisez: 'Samedi / concours / Il y a / prochain'.", choices: ["Il y a", "un", "concours", "samedi prochain"], correctOrder: ["Il y a", "un", "concours", "samedi prochain"], feedbackCorrect: "Très bien! La phrase correcte est 'Il y a un concours samedi prochain.'", feedbackIncorrect: "Essayez encore." },
      { id: "q4", type: "text", question: "Complétez: '___ (There will be) un concours important.'", correctKeywords: ["Il y aura"], feedbackCorrect: "Bravo! 'Il y aura un concours important.'", feedbackIncorrect: "Non, la bonne phrase est 'Il y aura un concours important.'" },
      { id: "q5", type: "mcq", question: "Que veut dire 'à l’âge de cinq ans'?", choices: ["At the age of five", "At five o'clock", "Five years ago", "In five years"], correct: "At the age of five", feedbackCorrect: "Correct! Cela signifie 'At the age of five'.", feedbackIncorrect: "Non, cela veut dire 'At the age of five'." },
      { id: "q6", type: "select", question: "Quel mot complète la phrase: 'Je rêve de ___ chanteur célèbre.'", choices: ["devenir", "faire", "jouer", "manger"], correct: "devenir", feedbackCorrect: "Exact! 'Je rêve de devenir chanteur célèbre.'", feedbackIncorrect: "Non, la bonne réponse est 'devenir'." },
      { id: "q7", type: "order", question: "Mettez en ordre: 'J’espère / réussir / dans / concours'.", choices: ["J’espère", "réussir", "dans", "le concours"], correctOrder: ["J’espère", "réussir", "dans", "le concours"], feedbackCorrect: "Bien joué! La phrase correcte est 'J’espère réussir dans le concours.'", feedbackIncorrect: "Essayez encore." },
      { id: "q8", type: "text", question: "Traduisez: 'There will be a competition next Saturday.'", correctKeywords: ["Il y aura", "concours", "samedi prochain"], feedbackCorrect: "Parfait! 'Il y aura un concours samedi prochain.'", feedbackIncorrect: "Non, essayez d'inclure les mots-clés." },
      { id: "q9", type: "mcq", question: "Quelle phrase est correcte?", choices: ["Il y aura un soirée.", "Il y aura une soirée.", "Il y a un soirée.", "Il y a une soirée."], correct: "Il y aura une soirée.", feedbackCorrect: "Exact! 'Il y aura une soirée.' est correct.", feedbackIncorrect: "Non, la bonne phrase est 'Il y aura une soirée.'." },
      { id: "q10", type: "select", question: "Que signifie 'dur'?", choices: ["Easy", "Hard", "Fast", "Slow"], correct: "Hard", feedbackCorrect: "'Dur' signifie 'hard' ou 'difficult'.", feedbackIncorrect: "Non, 'dur' signifie 'hard'." }
    ]
  },

  // Lesson 4
  {
    title: "Leçon 4: Parler des carrières et rêves",
    questions: [
      { id: "q1", type: "mcq", question: "Que signifie 'faire carrière dans'?", choices: ["To have a career in", "To lose a job", "To study", "To sing"], correct: "To have a career in", feedbackCorrect: "Correct! 'Faire carrière dans' means 'to have a career in'.", feedbackIncorrect: "Non, cela signifie 'to have a career in'." },
      { id: "q2", type: "select", question: "Complétez: 'Je rêve de ___ célèbre.'", choices: ["devenir", "faire", "jouer", "écouter"], correct: "devenir", feedbackCorrect: "Exact! 'Je rêve de devenir célèbre.'", feedbackIncorrect: "Non, la bonne réponse est 'devenir'." },
      { id: "q3", type: "order", question: "Mettez en ordre: 'plusieurs fois / Il / a / gagné / le concours'.", choices: ["Il", "a", "gagné", "plusieurs fois", "le concours"], correctOrder: ["Il", "a", "gagné", "plusieurs fois", "le concours"], feedbackCorrect: "Bien joué! 'Il a gagné plusieurs fois le concours.'", feedbackIncorrect: "Essayez encore." },
      { id: "q4", type: "text", question: "Traduisez: 'It’s the best in the world.'", correctKeywords: ["c’est", "le meilleur", "du monde"], feedbackCorrect: "Très bien! 'C’est le meilleur du monde.'", feedbackIncorrect: "Non, essayez d’inclure les mots-clés." },
      { id: "q5", type: "mcq", question: "Que veut dire 'un métier'?", choices: ["A job", "A dream", "A song", "An evening"], correct: "A job", feedbackCorrect: "Correct! 'Un métier' means 'a job'.", feedbackIncorrect: "Non, 'un métier' signifie 'a job'." },
      { id: "q6", type: "select", question: "Quelle phrase est correcte?", choices: ["Je rêve faire carrière dans la musique.", "Je rêve de faire carrière dans la musique.", "Je rêve à faire carrière dans la musique.", "Je rêve avec faire carrière dans la musique."], correct: "Je rêve de faire carrière dans la musique.", feedbackCorrect: "Exact! 'Je rêve de faire carrière dans la musique.' est correct.", feedbackIncorrect: "Non, la bonne phrase est 'Je rêve de faire carrière dans la musique.'" },
      { id: "q7", type: "order", question: "Remettez en ordre: 'Avoir / confiance / il / est important / en soi'.", choices: ["Il", "est important", "d’avoir", "confiance", "en soi"], correctOrder: ["Il", "est important", "d’avoir", "confiance", "en soi"], feedbackCorrect: "Bien joué! 'Il est important d’avoir confiance en soi.'", feedbackIncorrect: "Essayez encore." },
      { id: "q8", type: "text", question: "Complétez: 'On m’a dit que ___ très dur.'", correctKeywords: ["c’est", "dur"], feedbackCorrect: "Bravo! 'On m’a dit que c’est très dur.'", feedbackIncorrect: "Non, la bonne phrase est 'On m’a dit que c’est très dur.'" },
      { id: "q9", type: "mcq", question: "Que veut dire 'plusieurs fois'?", choices: ["Once", "Several times", "Never", "Always"], correct: "Several times", feedbackCorrect: "Correct! 'Plusieurs fois' means 'several times'.", feedbackIncorrect: "Non, cela veut dire 'several times'." },
      { id: "q10", type: "select", question: "Quelle phrase utilise une expression?", choices: ["Je chante une chanson.", "On m’a dit que le métier est dur.", "Je mange une pomme.", "Je vais à l’école."], correct: "On m’a dit que le métier est dur.", feedbackCorrect: "Exact! 'On m’a dit que' est une expression.", feedbackIncorrect: "Non, cherchez une phrase avec une expression." }
    ]
  },

  // Lesson 5
  {
    title: "Leçon 5: Activités et opinions avancées",
    questions: [
      { id: "q1", type: "mcq", question: "Que signifie 'chanter plusieurs fois'?", choices: ["To sing once", "To sing several times", "To dance", "To listen"], correct: "To sing several times", feedbackCorrect: "Correct! 'Chanter plusieurs fois' means 'to sing several times'.", feedbackIncorrect: "Incorrect. It means 'to sing several times'." },
      { id: "q2", type: "select", question: "Complétez: 'J’espère ___ gagner le concours.'", choices: ["de", "à", "pour", "à la"], correct: "de", feedbackCorrect: "Exact! La phrase correcte est 'J’espère de gagner le concours.'", feedbackIncorrect: "Non, la bonne réponse est 'de'." },
      { id: "q3", type: "order", question: "Réorganisez: 'dernier / le / concours / était / difficile'.", choices: ["Le", "dernier", "concours", "était", "difficile"], correctOrder: ["Le", "dernier", "concours", "était", "difficile"], feedbackCorrect: "Bien joué! 'Le dernier concours était difficile.'", feedbackIncorrect: "Essayez encore." },
      { id: "q4", type: "text", question: "Traduisez: 'I hope to have confidence.'", correctKeywords: ["j’espère", "avoir", "confiance"], feedbackCorrect: "Très bien! 'J’espère avoir confiance.'", feedbackIncorrect: "Non, essayez d’utiliser 'j’espère' et 'avoir confiance'." },
      { id: "q5", type: "mcq", question: "Quel est le contraire de 'dur'?", choices: ["Facile", "Rapide", "Lent", "Fort"], correct: "Facile", feedbackCorrect: "Correct! Le contraire de 'dur' est 'facile'.", feedbackIncorrect: "Non, le contraire de 'dur' est 'facile'." },
      { id: "q6", type: "select", question: "Quelle phrase est correcte?", choices: ["Il y aura plusieurs fois des compétitions.", "Il y aura plusieurs compétitions.", "Il y aura plusieurs fois.", "Il y a plusieurs fois."], correct: "Il y aura plusieurs compétitions.", feedbackCorrect: "Exact! 'Il y aura plusieurs compétitions.' est correct.", feedbackIncorrect: "Non, la bonne phrase est 'Il y aura plusieurs compétitions.'" },
      { id: "q7", type: "order", question: "Remettez en ordre: 'Je / faire / carrière / veux / dans la musique'.", choices: ["Je", "veux", "faire", "carrière", "dans la musique"], correctOrder: ["Je", "veux", "faire", "carrière", "dans la musique"], feedbackCorrect: "Bien joué! 'Je veux faire carrière dans la musique.'", feedbackIncorrect: "Essayez encore." },
      { id: "q8", type: "text", question: "Complétez: 'Le métier est ___ mais intéressant.'", correctKeywords: ["dur"], feedbackCorrect: "Bravo! 'Le métier est dur mais intéressant.'", feedbackIncorrect: "Non, la bonne phrase est 'Le métier est dur mais intéressant.'" },
      { id: "q9", type: "mcq", question: "Que veut dire 'un concours'?", choices: ["A competition", "A song", "An evening", "A career"], correct: "A competition", feedbackCorrect: "Correct! 'Un concours' means 'a competition'.", feedbackIncorrect: "Non, cela veut dire 'a competition'." },
      { id: "q10", type: "select", question: "Quelle expression signifie 'next Saturday'?", choices: ["Samedi prochain", "Le weekend dernier", "Demain", "Ce soir"], correct: "Samedi prochain", feedbackCorrect: "Exact! 'Samedi prochain' signifie 'next Saturday'.", feedbackIncorrect: "Non, la bonne réponse est 'Samedi prochain'." }
    ]
  },

  // Lesson 6
  {
    title: "Leçon 6: Écrire des phrases plus longues",
    questions: [
      { id: "q1", type: "text", question: "Écrivez une phrase en français utilisant 'Il y a' et 'un concours'.", correctKeywords: ["Il y a", "un concours"], feedbackCorrect: "Très bien! Vous avez utilisé 'Il y a un concours'.", feedbackIncorrect: "Essayez d'inclure 'Il y a' et 'un concours'." },
      { id: "q2", type: "order", question: "Mettez en ordre: 'J’espère / gagner / le concours / samedi prochain'.", choices: ["J’espère", "gagner", "le concours", "samedi prochain"], correctOrder: ["J’espère", "gagner", "le concours", "samedi prochain"], feedbackCorrect: "Bien joué! La phrase correcte est 'J’espère gagner le concours samedi prochain.'", feedbackIncorrect: "Essayez encore." },
      { id: "q3", type: "mcq", question: "Que signifie 'à l’âge de cinq ans'?", choices: ["At the age of five", "When I am five", "In five years", "Five o’clock"], correct: "At the age of five", feedbackCorrect: "Correct! Cela signifie 'At the age of five'.", feedbackIncorrect: "Non, cela veut dire 'At the age of five'." },
      { id: "q4", type: "select", question: "Complétez: 'On m’a dit que ___ très dur.'", choices: ["c’est", "il est", "elle est", "ce sera"], correct: "c’est", feedbackCorrect: "Exact! 'On m’a dit que c’est très dur.'", feedbackIncorrect: "Non, la bonne réponse est 'c’est'." },
      { id: "q5", type: "text", question: "Traduisez: 'I dream of becoming famous.'", correctKeywords: ["je", "rêve", "devenir", "célèbre"], feedbackCorrect: "Bravo! 'Je rêve de devenir célèbre.'", feedbackIncorrect: "Non, essayez d’utiliser les mots-clés." },
      { id: "q6", type: "mcq", question: "Que veut dire 'faire carrière dans la musique'?", choices: ["To have a career in music", "To play music", "To sing", "To write songs"], correct: "To have a career in music", feedbackCorrect: "Correct! 'Faire carrière dans la musique' means 'to have a career in music'.", feedbackIncorrect: "Non, cela signifie 'to have a career in music'." },
      { id: "q7", type: "order", question: "Réorganisez: 'C’est / le meilleur / du monde / concours'.", choices: ["C’est", "le meilleur", "du monde", "concours"], correctOrder: ["C’est", "le meilleur", "concours", "du monde"], feedbackCorrect: "Bien joué! La phrase correcte est 'C’est le meilleur concours du monde.'", feedbackIncorrect: "Essayez encore." },
      { id: "q8", type: "select", question: "Quelle phrase est correcte?", choices: ["Il y a un soirée.", "Il y a une soirée.", "Il y aura un soirée.", "Il y aura une soirée."], correct: "Il y a une soirée.", feedbackCorrect: "Exact! 'Il y a une soirée.' est correct.", feedbackIncorrect: "Non, la bonne phrase est 'Il y a une soirée.'." },
      { id: "q9", type: "text", question: "Complétez: 'Je ___ confiance en moi.'", correctKeywords: ["ai"], feedbackCorrect: "Bravo! 'J’ai confiance en moi.'", feedbackIncorrect: "Non, la bonne phrase est 'J’ai confiance en moi.'" },
      { id: "q10", type: "mcq", question: "Que signifie 'plusieurs fois'?", choices: ["Several times", "Once", "Never", "Always"], correct: "Several times", feedbackCorrect: "Correct! 'Plusieurs fois' means 'several times'.", feedbackIncorrect: "Non, cela signifie 'several times'." }
    ]
  },

  // Lesson 7
  {
    title: "Leçon 7: Questions et réponses avancées",
    questions: [
      { id: "q1", type: "mcq", question: "Comment demander 'When is the competition?'", choices: ["Quand est le concours?", "Où est le concours?", "Qui est le concours?", "Pourquoi est le concours?"], correct: "Quand est le concours?", feedbackCorrect: "Correct! 'Quand est le concours?' means 'When is the competition?'.", feedbackIncorrect: "Non, la bonne question est 'Quand est le concours?'." },
      { id: "q2", type: "select", question: "Quelle est la bonne réponse à 'Il y a un concours demain.'?", choices: ["Oui, je vais y participer.", "Non, je ne vais pas y chanter.", "Peut-être, j’espère gagner.", "Toutes ces réponses."], correct: "Toutes ces réponses.", feedbackCorrect: "Exact! Toutes ces réponses sont correctes selon le contexte.", feedbackIncorrect: "Non, toutes ces réponses peuvent être correctes." },
      { id: "q3", type: "order", question: "Remettez en ordre: 'Je / veux / faire carrière / dans la musique'.", choices: ["Je", "veux", "faire carrière", "dans la musique"], correctOrder: ["Je", "veux", "faire carrière", "dans la musique"], feedbackCorrect: "Bien joué! La phrase correcte est 'Je veux faire carrière dans la musique.'", feedbackIncorrect: "Essayez encore." },
      { id: "q4", type: "text", question: "Répondez en français: 'Do you hope to win the competition?'", correctKeywords: ["oui", "j’espère", "gagner"], feedbackCorrect: "Très bien! 'Oui, j’espère gagner le concours.'", feedbackIncorrect: "Essayez de répondre en utilisant 'j’espère' et 'gagner'." },
      { id: "q5", type: "mcq", question: "Que veut dire 'à l’âge de cinq ans'?", choices: ["At five years old", "At the age of five", "In five years", "Five years ago"], correct: "At the age of five", feedbackCorrect: "Correct! 'À l’âge de cinq ans' means 'at the age of five'.", feedbackIncorrect: "Non, cela signifie 'at the age of five'." },
      { id: "q6", type: "select", question: "Complétez: 'Il y aura ___ grand concours samedi prochain.'", choices: ["un", "une", "des", "le"], correct: "un", feedbackCorrect: "Exact! La phrase correcte est 'Il y aura un grand concours samedi prochain.'", feedbackIncorrect: "Non, la bonne réponse est 'un'." },
      { id: "q7", type: "order", question: "Mettez en ordre: 'J’espère / chanter / au concours / samedi prochain'.", choices: ["J’espère", "chanter", "au concours", "samedi prochain"], correctOrder: ["J’espère", "chanter", "au concours", "samedi prochain"], feedbackCorrect: "Bien joué! 'J’espère chanter au concours samedi prochain.'", feedbackIncorrect: "Essayez encore." },
      { id: "q8", type: "text", question: "Traduisez: 'I want to have confidence in myself.'", correctKeywords: ["je", "veux", "avoir", "confiance", "en moi"], feedbackCorrect: "Bravo! 'Je veux avoir confiance en moi.'", feedbackIncorrect: "Essayez d'inclure les mots-clés." },
      { id: "q9", type: "mcq", question: "Quel est le contraire de 'difficile'?", choices: ["Facile", "Dur", "Rapide", "Lent"], correct: "Facile", feedbackCorrect: "Correct! Le contraire de 'difficile' est 'facile'.", feedbackIncorrect: "Non, le contraire de 'difficile' est 'facile'." },
      { id: "q10", type: "select", question: "Que signifie 'une soirée'?", choices: ["An evening", "A competition", "A song", "A singer"], correct: "An evening", feedbackCorrect: "Exact! 'Une soirée' means 'an evening'.", feedbackIncorrect: "Non, cela signifie 'an evening'." }
    ]
  },

  // Lesson 8
  {
    title: "Leçon 8: Opinions et phrases complexes",
    questions: [
      { id: "q1", type: "mcq", question: "Que signifie 'J’aime chanter'?", choices: ["I like to sing", "I have to sing", "I can sing", "I must sing"], correct: "I like to sing", feedbackCorrect: "Correct! 'J’aime chanter' means 'I like to sing'.", feedbackIncorrect: "Non, cela signifie 'I like to sing'." },
      { id: "q2", type: "select", question: "Complétez: 'Je préfère ___ écouter de la musique.'", choices: ["regarder", "écouter", "jouer", "chanter"], correct: "écouter", feedbackCorrect: "Exact! 'Je préfère écouter de la musique.'", feedbackIncorrect: "Non, la bonne réponse est 'écouter'." },
      { id: "q3", type: "order", question: "Réorganisez: 'Je / regarder / des émissions / en streaming'.", choices: ["Je", "regarder", "des émissions", "en streaming"], correctOrder: ["Je", "regarder", "des émissions", "en streaming"], feedbackCorrect: "Bien joué! 'Je regarder des émissions en streaming.'", feedbackIncorrect: "Essayez encore." },
      { id: "q4", type: "text", question: "Traduisez: 'I prefer to listen to music.'", correctKeywords: ["je", "préfère", "écouter", "de la musique"], feedbackCorrect: "Très bien! 'Je préfère écouter de la musique.'", feedbackIncorrect: "Non, essayez d’utiliser les mots-clés." },
      { id: "q5", type: "mcq", question: "Que veut dire 'surfer sur Internet'?", choices: ["To surf the internet", "To swim", "To listen", "To play games"], correct: "To surf the internet", feedbackCorrect: "Correct! 'Surfer sur Internet' means 'to surf the internet'.", feedbackIncorrect: "Non, cela signifie 'to surf the internet'." },
      { id: "q6", type: "select", question: "Complétez: 'Je joue ___ jeux en ligne.'", choices: ["à", "de", "du", "des"], correct: "à", feedbackCorrect: "Exact! 'Je joue à des jeux en ligne.'", feedbackIncorrect: "Non, la bonne réponse est 'à'." },
      { id: "q7", type: "order", question: "Mettez en ordre: 'J’aime / écouter / de la musique / en ligne'.", choices: ["J’aime", "écouter", "de la musique", "en ligne"], correctOrder: ["J’aime", "écouter", "de la musique", "en ligne"], feedbackCorrect: "Bien joué! 'J’aime écouter de la musique en ligne.'", feedbackIncorrect: "Essayez encore." },
      { id: "q8", type: "text", question: "Complétez: 'Je ___ regarder des émissions en streaming.'", correctKeywords: ["aime"], feedbackCorrect: "Bravo! 'J’aime regarder des émissions en streaming.'", feedbackIncorrect: "Non, la bonne phrase est 'J’aime regarder des émissions en streaming.'" },
      { id: "q9", type: "mcq", question: "Que signifie 'des émissions en streaming'?", choices: ["Streaming shows", "Songs", "Games", "Competitions"], correct: "Streaming shows", feedbackCorrect: "Correct! 'Des émissions en streaming' means 'streaming shows'.", feedbackIncorrect: "Non, cela signifie 'streaming shows'." },
      { id: "q10", type: "select", question: "Quelle phrase est correcte?", choices: ["Je préfère écouter de la musique.", "Je préfère écouter la musique.", "Je préfère écouter des musiques.", "Je préfère écouter du musique."], correct: "Je préfère écouter de la musique.", feedbackCorrect: "Exact! 'Je préfère écouter de la musique.' est correct.", feedbackIncorrect: "Non, la bonne phrase est 'Je préfère écouter de la musique.'" }
    ]
  },

  // Lesson 9
  {
    title: "Leçon 9: Décrire les festivals et événements",
    questions: [
      { id: "q1", type: "mcq", question: "Que signifie 'festival'?", choices: ["Festival", "Competition", "Song", "Dance"], correct: "Festival", feedbackCorrect: "Correct! 'Festival' means 'festival'.", feedbackIncorrect: "Non, cela signifie 'festival'." },
      { id: "q2", type: "select", question: "Complétez: 'Le festival est ___ populaire.'", choices: ["très", "pas", "peu", "plus"], correct: "très", feedbackCorrect: "Exact! 'Le festival est très populaire.'", feedbackIncorrect: "Non, la bonne réponse est 'très'." },
      { id: "q3", type: "order", question: "Réorganisez: 'Les gens / marchent / sur le tapis rouge'.", choices: ["Les gens", "marchent", "sur le tapis rouge"], correctOrder: ["Les gens", "marchent", "sur le tapis rouge"], feedbackCorrect: "Bien joué! 'Les gens marchent sur le tapis rouge.'", feedbackIncorrect: "Essayez encore." },
      { id: "q4", type: "text", question: "Traduisez: 'They walk on the red carpet.'", correctKeywords: ["ils", "marchent", "sur", "le tapis rouge"], feedbackCorrect: "Bravo! 'Ils marchent sur le tapis rouge.'", feedbackIncorrect: "Non, essayez d’inclure les mots-clés." },
      { id: "q5", type: "mcq", question: "Que veut dire 'participer au festival'?", choices: ["To take part in the festival", "To watch a show", "To sing", "To dance"], correct: "To take part in the festival", feedbackCorrect: "Correct! 'Participer au festival' means 'to take part in the festival'.", feedbackIncorrect: "Non, cela signifie 'to take part in the festival'." },
      { id: "q6", type: "select", question: "Complétez: 'Les célébrités ___ au festival.'", choices: ["vont", "va", "allez", "vais"], correct: "vont", feedbackCorrect: "Exact! 'Les célébrités vont au festival.'", feedbackIncorrect: "Non, la bonne réponse est 'vont'." },
      { id: "q7", type: "order", question: "Mettez en ordre: 'Ils / vont / participer / au festival'.", choices: ["Ils", "vont", "participer", "au festival"], correctOrder: ["Ils", "vont", "participer", "au festival"], feedbackCorrect: "Bien joué! 'Ils vont participer au festival.'", feedbackIncorrect: "Essayez encore." },
      { id: "q8", type: "text", question: "Complétez: 'Les célébrités ___ marcher sur le tapis rouge.'", correctKeywords: ["vont"], feedbackCorrect: "Bravo! 'Les célébrités vont marcher sur le tapis rouge.'", feedbackIncorrect: "Non, la bonne phrase est 'Les célébrités vont marcher sur le tapis rouge.'" },
      { id: "q9", type: "mcq", question: "Que signifie 'le tapis rouge'?", choices: ["Red carpet", "Stage", "Audience", "Music"], correct: "Red carpet", feedbackCorrect: "Correct! 'Le tapis rouge' means 'red carpet'.", feedbackIncorrect: "Non, cela signifie 'red carpet'." },
      { id: "q10", type: "select", question: "Quelle phrase est correcte?", choices: ["Les célébrités vont marcher.", "Les célébrités vont marcher sur le tapis rouge.", "Les célébrités marcheront tapis rouge.", "Les célébrités marcher tapis rouge."], correct: "Les célébrités vont marcher sur le tapis rouge.", feedbackCorrect: "Exact! La phrase correcte est 'Les célébrités vont marcher sur le tapis rouge.'", feedbackIncorrect: "Non, la bonne phrase est 'Les célébrités vont marcher sur le tapis rouge.'" }
    ]
  },

  // Lesson 10
  {
    title: "Leçon 10: Révision et consolidation",
    questions: [
      { id: "q1", type: "mcq", question: "Que signifie 'concours'?", choices: ["Competition", "Song", "Evening", "Singer"], correct: "Competition", feedbackCorrect: "Correct! 'Concours' means 'competition'.", feedbackIncorrect: "Non, cela signifie 'competition'." },
      { id: "q2", type: "select", question: "Complétez: 'Je veux ___ chanter.'", choices: ["de", "à", "pour", "à la"], correct: "de", feedbackCorrect: "Exact! 'Je veux de chanter.' est incorrect, la bonne phrase est 'Je veux chanter.'", feedbackIncorrect: "Non, la bonne réponse est 'Je veux chanter.'" },
      { id: "q3", type: "order", question: "Réorganisez: 'J’espère / réussir / dans / le concours'.", choices: ["J’espère", "réussir", "dans", "le concours"], correctOrder: ["J’espère", "réussir", "dans", "le concours"], feedbackCorrect: "Bien joué! La phrase correcte est 'J’espère réussir dans le concours.'", feedbackIncorrect: "Essayez encore." },
      { id: "q4", type: "text", question: "Traduisez: 'I want to win the competition.'", correctKeywords: ["je", "veux", "gagner", "le concours"], feedbackCorrect: "Très bien! 'Je veux gagner le concours.'", feedbackIncorrect: "Non, essayez d'inclure les mots-clés." },
      { id: "q5", type: "mcq", question: "Que veut dire 'une soirée'?", choices: ["An evening", "A competition", "A song", "A singer"], correct: "An evening", feedbackCorrect: "Correct! 'Une soirée' means 'an evening'.", feedbackIncorrect: "Non, cela signifie 'an evening'." },
      { id: "q6", type: "select", question: "Complétez: 'Je ___ confiance en moi.'", choices: ["ai", "a", "es", "suis"], correct: "ai", feedbackCorrect: "Exact! 'J’ai confiance en moi.' est correct.", feedbackIncorrect: "Non, la bonne réponse est 'ai'." },
      { id: "q7", type: "order", question: "Mettez en ordre: 'Je / veux / faire carrière / dans la musique'.", choices: ["Je", "veux", "faire carrière", "dans la musique"], correctOrder: ["Je", "veux", "faire carrière", "dans la musique"], feedbackCorrect: "Bien joué! 'Je veux faire carrière dans la musique.'", feedbackIncorrect: "Essayez encore." },
      { id: "q8", type: "text", question: "Complétez: 'Il y aura ___ grand concours samedi prochain.'", correctKeywords: ["un"], feedbackCorrect: "Bravo! 'Il y aura un grand concours samedi prochain.'", feedbackIncorrect: "Non, la bonne phrase est 'Il y aura un grand concours samedi prochain.'" },
      { id: "q9", type: "mcq", question: "Que signifie 'plusieurs fois'?", choices: ["Several times", "Once", "Never", "Always"], correct: "Several times", feedbackCorrect: "Correct! 'Plusieurs fois' means 'several times'.", feedbackIncorrect: "Non, cela signifie 'several times'." },
      { id: "q10", type: "select", question: "Quelle phrase est correcte?", choices: ["Il y aura une soirée.", "Il y aura un soirée.", "Il y a une soirée.", "Il y a un soirée."], correct: "Il y aura une soirée.", feedbackCorrect: "Exact! 'Il y aura une soirée.' est correct.", feedbackIncorrect: "Non, la bonne phrase est 'Il y aura une soirée.'" }
    ]
  }
]

If you want, I can help build a full interactive web app for these lessons. Would you like that?
  // Lesson 3, 4... up to Lesson 10 similar format with vocabulary from our earlier chats...

  // Example placeholder for next lessons - I can fully expand all if you want now, or lesson by lesson?

];
  // Adding placeholders to reach 10 lessons total
  while (lessons.length < 10) {
    const n = lessons.length + 1;
    lessons.push({
      title: `Lesson ${n}: Placeholder`,
      questions: [
        {
          id: `q1`,
          type: "mcq",
          question: `Placeholder question 1 for lesson ${n}?`,
          choices: [
            {value: "a", text: "Option A"},
            {value: "b", text: "Option B"},
            {value: "c", text: "Option C"}
          ],
          correct: "a",
          feedbackCorrect: "Correct!",
          feedbackIncorrect: "Incorrect."
        },
        {
          id: `q2`,
          type: "mcq",
          question: `Placeholder question 2 for lesson ${n}?`,
          choices: [
            {value: "a", text: "Option A"},
            {value: "b", text: "Option B"}
          ],
          correct: "b",
          feedbackCorrect: "Correct!",
          feedbackIncorrect: "Incorrect."
        }
      ]
    });
  }

  // Variables to track state
  let currentLesson = 0;
  const userAnswers = {}; // keys: lesson-qid, values: {answered: bool, correct: bool}

  const lessonsContainer = document.getElementById("lessons-container");
  const prevBtn = document.getElementById("prevLessonBtn");
  const nextBtn = document.getElementById("nextLessonBtn");
  const progressFill = document.getElementById("progress-fill");
  const finalScoreDiv = document.getElementById("final-score");

  // Render all lessons (hidden initially)
  function renderLessons() {
    lessonsContainer.innerHTML = "";
    lessons.forEach((lesson, idx) => {
      const lessonDiv = document.createElement("div");
      lessonDiv.classList.add("lesson");
      if(idx === currentLesson) lessonDiv.classList.add("active");
      lessonDiv.setAttribute("data-lesson-index", idx);

      const titleH2 = document.createElement("h2");
      titleH2.textContent = lesson.title;
      lessonDiv.appendChild(titleH2);

      // Questions container
      lesson.questions.forEach((q, qIdx) => {
        const qDiv = document.createElement("div");
        qDiv.classList.add("question");
        qDiv.id = `lesson${idx}-question${qIdx}`;

        const qText = document.createElement("p");
        qText.textContent = `${qIdx+1}. ${q.question}`;
        qDiv.appendChild(qText);

        // Depending on type render differently
        if(q.type === "mcq") {
          q.choices.forEach(choice => {
            const label = document.createElement("label");
            label.htmlFor = `${q.id}-${choice.value}-lesson${idx}`;
            label.textContent = choice.text;
            const input = document.createElement("input");
            input.type = "radio";
            input.name = `${q.id}-lesson${idx}`;
            input.id = `${q.id}-${choice.value}-lesson${idx}`;
            input.value = choice.value;
            label.prepend(input);
            qDiv.appendChild(label);
          });
        }
        else if(q.type === "text") {
          const textarea = document.createElement("textarea");
          textarea.id = `${q.id}-input-lesson${idx}`;
          textarea.rows = 3;
          textarea.placeholder = "Write your answer here...";
          qDiv.appendChild(textarea);
        }
        else if(q.type === "order") {
          // Show clickable parts to reorder, user clicks to build answer below
          const partsDiv = document.createElement("div");
          partsDiv.id = `${q.id}-choices-lesson${idx}`;
          partsDiv.style.marginBottom = "0.5rem";

          q.choices.forEach(part => {
            const btn = document.createElement("button");
            btn.type = "button";
            btn.textContent = part;
            btn.style.margin = "0.15rem";
            btn.style.borderRadius = "5px";
            btn.style.border = "1px solid #4c51bf";
            btn.style.background = "white";
            btn.style.cursor = "pointer";
            btn.addEventListener("click", () => selectOrderPart(idx, qIdx, part, btn));
            partsDiv.appendChild(btn);
          });
          qDiv.appendChild(partsDiv);

          // Area to show selected order
          const answerDiv = document.createElement("div");
          answerDiv.id = `${q.id}-answer-lesson${idx}`;
          answerDiv.style.minHeight = "24px";
          answerDiv.style.fontWeight = "600";
          answerDiv.style.marginBottom = "0.3rem";
          qDiv.appendChild(answerDiv);

          // Button to clear selection
          const clearBtn = document.createElement("button");
          clearBtn.type = "button";
          clearBtn.textContent = "Clear selection";
          clearBtn.style.marginBottom = "0.3rem";
          clearBtn.addEventListener("click", () => clearOrderAnswer(idx, qIdx));
          qDiv.appendChild(clearBtn);
        }
        else if(q.type === "select") {
          // Like mcq but only one choice, buttons user clicks to select
          const selectDiv = document.createElement("div");
          selectDiv.id = `${q.id}-select-lesson${idx}`;
          q.choices.forEach(choice => {
            const btn = document.createElement("button");
            btn.type = "button";
            btn.textContent = choice;
            btn.style.margin = "0.15rem";
            btn.style.borderRadius = "5px";
            btn.style.border = "1px solid #4c51bf";
            btn.style.background = "white";
            btn.style.cursor = "pointer";
            btn.addEventListener("click", () => selectSingleChoice(idx, qIdx, choice, btn));
            selectDiv.appendChild(btn);
          });
          qDiv.appendChild(selectDiv);

          // Display selected answer
          const selectedAnswerDiv = document.createElement("div");
          selectedAnswerDiv.id = `${q.id}-selected-answer-lesson${idx}`;
          selectedAnswerDiv.style.fontWeight = "600";
          selectedAnswerDiv.style.marginTop = "0.3rem";
          qDiv.appendChild(selectedAnswerDiv);
        }

        // Button to check answer
        const checkBtn = document.createElement("button");
        checkBtn.type = "button";
        checkBtn.textContent = "Check Answer";
        checkBtn.style.marginTop = "0.5rem";
        checkBtn.addEventListener("click", () => checkAnswer(idx, qIdx));
        qDiv.appendChild(checkBtn);

        // Feedback area
        const feedbackDiv = document.createElement("div");
        feedbackDiv.id = `${q.id}-feedback-lesson${idx}`;
        feedbackDiv.classList.add("feedback");
        qDiv.appendChild(feedbackDiv);

        lessonDiv.appendChild(qDiv);
      });

      lessonsContainer.appendChild(lessonDiv);
    });
  }

  // Selected parts for reorder questions tracking
  const orderSelections = {}; // key = lesson-q, value = array of selected parts

  // For select question type (single choice)
  const selectSelections = {}; // key = lesson-q, value = selected choice string

  function selectOrderPart(lessonIdx, questionIdx, part, btn) {
    const key = `${lessonIdx}-${questionIdx}`;
    if(!orderSelections[key]) orderSelections[key] = [];
    if(orderSelections[key].includes(part)) return; // no duplicates
    orderSelections[key].push(part);
    btn.disabled = true;
    updateOrderAnswerDisplay(lessonIdx, questionIdx);
  }

  function clearOrderAnswer(lessonIdx, questionIdx) {
    const key = `${lessonIdx}-${questionIdx}`;
    orderSelections[key] = [];
    // Enable all buttons again
    const lesson = lessonsContainer.querySelector(`[data-lesson-index="${lessonIdx}"]`);
    if (!lesson) return;
    const choicesDiv = lesson.querySelector(`#lesson${lessonIdx}-question${questionIdx} div[id^="${lessons[lessonIdx].questions[questionIdx].id}-choices"]`);
    if(choicesDiv) {
      [...choicesDiv.children].forEach(btn => btn.disabled = false);
    }
    updateOrderAnswerDisplay(lessonIdx, questionIdx);
  }

  function updateOrderAnswerDisplay(lessonIdx, questionIdx) {
    const key = `${lessonIdx}-${questionIdx}`;
    const answerDiv = document.getElementById(`${lessons[lessonIdx].questions[questionIdx].id}-answer-lesson${lessonIdx}`);
    answerDiv.textContent = orderSelections[key] ? orderSelections[key].join(" ") : "";
  }

  function selectSingleChoice(lessonIdx, questionIdx, choice, btn) {
    const key = `${lessonIdx}-${questionIdx}`;
    selectSelections[key] = choice;
    // Update button styles to highlight selection
    const selectDiv = document.getElementById(`${lessons[lessonIdx].questions[questionIdx].id}-select-lesson${lessonIdx}`);
    if (!selectDiv) return;
    [...selectDiv.children].forEach(b => {
      b.style.background = (b.textContent === choice) ? "#667eea" : "white";
      b.style.color = (b.textContent === choice) ? "white" : "black";
    });
    const selectedAnswerDiv = document.getElementById(`${lessons[lessonIdx].questions[questionIdx].id}-selected-answer-lesson${lessonIdx}`);
    selectedAnswerDiv.textContent = `You selected: ${choice}`;
  }

  // Check answer logic
  function checkAnswer(lessonIdx, questionIdx) {
    const lesson = lessons[lessonIdx];
    const question = lesson.questions[questionIdx];
    const feedbackDiv = document.getElementById(`${question.id}-feedback-lesson${lessonIdx}`);
    feedbackDiv.textContent = "";
    feedbackDiv.classList.remove("correct", "incorrect");

    let userCorrect = false;

    if(question.type === "mcq") {
      const selected = document.querySelector(`input[name="${question.id}-lesson${lessonIdx}"]:checked`);
      if(!selected) {
        feedbackDiv.textContent = "Please select an answer.";
        feedbackDiv.classList.add("incorrect");
        return;
      }
      if(selected.value === question.correct) {
        userCorrect = true;
        feedbackDiv.textContent = question.feedbackCorrect;
        feedbackDiv.classList.add("correct");
      } else {
        feedbackDiv.textContent = question.feedbackIncorrect;
        feedbackDiv.classList.add("incorrect");
      }
    }
    else if(question.type === "text") {
      const input = document.getElementById(`${question.id}-input-lesson${lessonIdx}`);
      const val = input.value.trim().toLowerCase();
      if(val === "") {
        feedbackDiv.textContent = "Please enter your answer.";
        feedbackDiv.classList.add("incorrect");
        return;
      }
      // Check if all keywords present (simple approach)
      const allPresent = question.correctKeywords.every(kw => val.includes(kw));
      if(allPresent) {
        userCorrect = true;
        feedbackDiv.textContent = question.feedbackCorrect;
        feedbackDiv.classList.add("correct");
      } else {
        feedbackDiv.textContent = question.feedbackIncorrect;
        feedbackDiv.classList.add("incorrect");
      }
    }
    else if(question.type === "order") {
      const key = `${lessonIdx}-${questionIdx}`;
      const userOrder = orderSelections[key] || [];
      if(userOrder.length !== question.correctOrder.length) {
        feedbackDiv.textContent = `Please select all parts in correct order (currently ${userOrder.length} of ${question.correctOrder.length}).`;
        feedbackDiv.classList.add("incorrect");
        return;
      }
      let matches = true;
      for(let i=0; i<userOrder.length; i++) {
        if(userOrder[i] !== question.correctOrder[i]) {
          matches = false;
          break;
        }
      }
      if(matches) {
        userCorrect = true;
        feedbackDiv.textContent = question.feedbackCorrect;
        feedbackDiv.classList.add("correct");
      } else {
        feedbackDiv.textContent = question.feedbackIncorrect;
        feedbackDiv.classList.add("incorrect");
      }
    }
    else if(question.type === "select") {
      const key = `${lessonIdx}-${questionIdx}`;
      const selected = selectSelections[key];
      if(!selected) {
        feedbackDiv.textContent = "Please select an option.";
        feedbackDiv.classList.add("incorrect");
        return;
      }
      if(selected === question.correct) {
        userCorrect = true;
        feedbackDiv.textContent = question.feedbackCorrect;
        feedbackDiv.classList.add("correct");
      } else {
        feedbackDiv.textContent = question.feedbackIncorrect;
        feedbackDiv.classList.add("incorrect");
      }
    }

    // Save answer correctness to userAnswers
    userAnswers[`${lessonIdx}-${questionIdx}`] = {
      answered: true,
      correct: userCorrect
    };

    updateProgress();
  }

  // Update progress bar and navigation buttons
  function updateProgress() {
    // Calculate total questions answered
    let totalQs = 0;
    let totalCorrect = 0;
    lessons.forEach((lesson, lIdx) => {
      lesson.questions.forEach((q, qIdx) => {
        totalQs++;
        const key = `${lIdx}-${qIdx}`;
        if(userAnswers[key] && userAnswers[key].correct) totalCorrect++;
      });
    });

    const progressPercent = ((currentLesson) / (lessons.length)) * 100;
    progressFill.style.width = progressPercent + "%";

    // Enable/disable buttons
    prevBtn.disabled = (currentLesson === 0);
    nextBtn.textContent = (currentLesson === lessons.length - 1) ? "Finish" : "Next Lesson →";

    // If on last lesson and finished, show final score
    if(currentLesson === lessons.length - 1) {
      // Check if all questions answered in last lesson
      const lastLessonQs = lessons[currentLesson].questions.length;
      const lastLessonAnswered = lessons[currentLesson].questions.every((q, qIdx) => {
        return userAnswers[`${currentLesson}-${qIdx}`] && userAnswers[`${currentLesson}-${qIdx}`].answered;
      });
      if(lastLessonAnswered) {
        // Show final score if all lessons answered fully
        const allAnswered = lessons.every((lesson, lIdx) => {
          return lesson.questions.every((q, qIdx) => userAnswers[`${lIdx}-${qIdx}`] && userAnswers[`${lIdx}-${qIdx}`].answered);
        });
        if(allAnswered) {
          showFinalScore(totalCorrect, totalQs);
        } else {
          finalScoreDiv.style.display = "none";
        }
      } else {
        finalScoreDiv.style.display = "none";
      }
    } else {
      finalScoreDiv.style.display = "none";
    }
  }

  // Show final score message
  function showFinalScore(correctCount, totalQuestions) {
    finalScoreDiv.style.display = "block";
    const percent = Math.round((correctCount / totalQuestions) * 100);
    finalScoreDiv.textContent = `Congratulations! You answered ${correctCount} out of ${totalQuestions} questions correctly. Your score: ${percent}%`;
  }

  // Navigation buttons handlers
  prevBtn.addEventListener("click", () => {
    if(currentLesson > 0) {
      switchLesson(currentLesson - 1);
    }
  });
  nextBtn.addEventListener("click", () => {
    if(currentLesson < lessons.length - 1) {
      switchLesson(currentLesson + 1);
    } else {
      // On Finish, check if all answered and show score
      const allAnswered = lessons.every((lesson, lIdx) => {
        return lesson.questions.every((q, qIdx) => userAnswers[`${lIdx}-${qIdx}`] && userAnswers[`${lIdx}-${qIdx}`].answered);
      });
      if(!allAnswered) {
        alert("Please answer all questions in all lessons before finishing.");
        return;
      }
      // Show score (already handled in updateProgress)
      alert("You have completed all lessons. See your score below.");
      updateProgress();
    }
  });

  function switchLesson(newIdx) {
    if(newIdx < 0 || newIdx >= lessons.length) return;
    // Hide current lesson
    const currentDiv = lessonsContainer.querySelector(`.lesson.active`);
    if(currentDiv) currentDiv.classList.remove("active");
    // Show new lesson
    const newDiv = lessonsContainer.querySelector(`[data-lesson-index="${newIdx}"]`);
    if(newDiv) newDiv.classList.add("active");
    currentLesson = newIdx;
    updateProgress();
  }

  // Initial render
  renderLessons();
  updateProgress();

</script>

</body>
</html>